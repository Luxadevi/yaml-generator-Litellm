<!DOCTYPE html>
<html>
<head>
    <title>LiteLLM Config Generator</title>
    <script type="text/javascript">
        var providerOptions = {{ options.providers | tojson | safe }};

        function updateProviderFields() {
            var provider = document.getElementById('providers').value;
            var fieldContainer = document.getElementById('provider-fields');

            // Clear existing fields
            fieldContainer.innerHTML = '';

            // Add new fields based on the selected provider
            if (providerOptions[provider]) {
                providerOptions[provider].fields.forEach(fieldObj => {
                    var fieldName = Object.keys(fieldObj)[0];
                    var fieldType = fieldObj[fieldName];

                    var label = document.createElement('label');
                    label.htmlFor = fieldName;
                    label.appendChild(document.createTextNode(fieldName.charAt(0).toUpperCase() + fieldName.slice(1) + ': '));
                    fieldContainer.appendChild(label);

                    if (typeof fieldType === 'object' && fieldType.type === 'select') {
                        var select = document.createElement('select');
                        select.name = fieldName;
                        select.id = fieldName;

                        fieldType.options.forEach(option => {
                            var optionElement = document.createElement('option');
                            optionElement.value = option;
                            optionElement.textContent = option;
                            select.appendChild(optionElement);
                        });

                        fieldContainer.appendChild(select);
                    } else {
                        var input = document.createElement('input');
                        input.type = fieldType === 'checkbox' ? 'checkbox' : 'text';
                        input.name = fieldName;
                        input.id = fieldName;
                        fieldContainer.appendChild(input);
                    }

                    fieldContainer.appendChild(document.createElement('br'));
                });
            }
        }
        function submitForm() {
    var formData = new FormData(document.querySelector('form'));

    fetch('/', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.yaml) {
            document.getElementById('yaml_output').textContent = data.yaml;
        }
    })
    .catch(error => console.error('Error:', error));

    return false; // Prevent form from submitting the traditional way
}

    </script>
</head>
<body>
    <h1>LiteLLM Config Generator</h1>
    <form method="post" onsubmit="return submitForm();">
        <!-- Field for model name -->
        <label for="model_name">Model Name:</label>
        <input type="text" id="model_name" name="model_name">
        <br>

        <!-- Dropdown for providers -->
        <label for="providers">Choose a provider:</label>
        <select name="providers" id="providers" onchange="updateProviderFields()">
            <option value="">Select a provider</option>
            {% for provider in options.providers %}
            <option value="{{ provider }}">{{ provider }}</option>
            {% endfor %}
        </select>
        <br>

        <!-- Container for dynamic provider fields -->
        <div id="provider-fields"></div>

        <!-- Field for output directory -->
        <label for="output_dir">Output Directory (optional):</label>
        <input type="text" id="output_dir" name="output_dir">
        <br>

        <!-- Checkbox for only showing YAML -->
        <label for="show_yaml">Only Show Generated YAML:</label>
        <input type="checkbox" id="show_yaml" name="show_yaml">
        <br>

        <input type="submit" value="Generate YAML">
    </form>

    <!-- Div to display YAML -->
    <div id="yaml_output" style="white-space: pre-wrap; margin-top: 20px; border: 1px solid #ccc; padding: 10px;"></div>
</body>
</html>
