<!DOCTYPE html>
<html>
<head>
    <title>LiteLLM Config Generator</title>
    <script type="text/javascript">
        function updateProviderFields() {
            var providerOptions = {{ options.providers | tojson | safe }};
            var provider = document.getElementById('providers').value;
            var fieldContainer = document.getElementById('provider-fields');

            fieldContainer.innerHTML = ''; // Clear existing fields

            if (providerOptions[provider]) {
                var fields = providerOptions[provider].fields;
                fields.forEach(function(fieldObj) {
                    var key = Object.keys(fieldObj)[0];
                    var label = document.createElement('label');
                    label.htmlFor = key;
                    label.innerText = key.charAt(0).toUpperCase() + key.slice(1) + ': ';
                    fieldContainer.appendChild(label);

                    var input = document.createElement('input');
                    input.type = fieldObj[key] === 'checkbox' ? 'checkbox' : 'text';
                    input.name = key;
                    input.id = key;
                    fieldContainer.appendChild(input);
                    fieldContainer.appendChild(document.createElement('br'));
                });
            }
        }

        function submitForm() {
            var formData = new FormData(document.querySelector('form'));

            fetch('/', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.yaml) {
                    document.getElementById('yaml_output').textContent = data.yaml;
                }
            })
            .catch(error => console.error('Error:', error));

            return false; // Prevent form from submitting the traditional way
        }
    </script>
</head>
<body>
    <h1>LiteLLM Config Generator</h1>
    <form method="post" onsubmit="return submitForm();">
        <label for="model_name">Model Name:</label>
        <input type="text" id="model_name" name="model_name"><br>

        <label for="providers">Choose a provider:</label>
        <select name="providers" id="providers" onchange="updateProviderFields()">
            <option value="">Select a provider</option>
            {% for provider in options.providers %}
            <option value="{{ provider }}">{{ provider }}</option>
            {% endfor %}
        </select><br>

        <div id="provider-fields"></div>

        <label for="output_dir">Output Directory (optional):</label>
        <input type="text" id="output_dir" name="output_dir"><br>

        <label for="show_yaml">Only Show Generated YAML:</label>
        <input type="checkbox" id="show_yaml" name="show_yaml"><br>

        <input type="submit" value="Generate YAML">
    </form>

    <div id="yaml_output" style="white-space: pre-wrap; margin-top: 20px; border: 1px solid #ccc; padding: 10px;"></div>
</body>
</html>
